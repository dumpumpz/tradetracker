<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Live Trade & Journal Tracker</title>
    <style>
        /* ... (Existing CSS remains largely the same) ... */

        /* Mobile-First Responsive Styles */
        .collapsible {
            border: 1px solid var(--border-color);
            border-radius: 8px;
            background-color: var(--card-bg);
            margin-bottom: 15px;
            overflow: hidden; /* Hide content when collapsed */
        }

        .collapsible-header {
            background-color: var(--header-bg);
            padding: 10px 15px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid var(--border-color);
        }

        .collapsible-header h2 {
            margin: 0;
            font-size: 16px;
            font-weight: 500;
            color: var(--text-color);
        }

        .collapsible-content {
            padding: 15px;
            display: block; /* Show content by default */
        }

        .collapsible-content.collapsed {
            display: none; /* Hide content when collapsed */
        }

        .collapsible-toggle {
            background: none;
            border: none;
            color: var(--subtle-text);
            width: 24px;
            height: 24px;
            border-radius: 50%;
            font-size: 20px;
            line-height: 20px;
            text-align: center;
            cursor: pointer;
            font-weight: bold;
            margin: 0;
            transition: transform 0.3s ease;
        }

        .collapsible-header:hover .collapsible-toggle {
            color: var(--link-color);
        }
        .collapsible-content.collapsed ~ .collapsible-header .collapsible-toggle {
            transform: rotate(90deg); /* Rotate arrow when collapsed */
        }

        /*Improve Table responsiveness */
        .table-wrapper {
            overflow-x: auto;
            width: 100%; /* Ensure table takes full width */
        }
        table { width: 100%; }
        table th, table td {
            text-align: left; /* Align content in the table cells */
            padding: 8px; 
            font-size: 14px; 
        }
        table th {
            background-color: var(--header-bg);
            font-weight: bold;
            vertical-align: middle;
        }
        @media (max-width: 768px) {
            table th, table td { font-size: 12px; padding: 6px; } /* Smaller font and padding for mobile */
            table th, table td { white-space: normal; word-wrap: break-word;} /* Allow text wrap for mobile */
        }

        /*Styling for Sections (making them collapsible)*/
        #asset-sentiment-container, #image-library-section, #ema-data-section, #chart-library-2-section, #sr-levels-tab {
            border: 1px solid var(--border-color);
            border-radius: 8px;
            background-color: var(--card-bg);
            margin-bottom: 15px;
            overflow: hidden;
        }

        #asset-sentiment-container .sentiment-trackers-wrapper {
            flex-direction: column; /* Stack vertically on mobile */
            gap: 10px;
        }

        #image-library-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
        }

        /* More concise media query for mobile adjustments */
        @media (max-width: 768px) {
            .tabs { flex-direction: column; }
            .tab-link { width: 100%; text-align: center; margin-bottom: 5px; }
            .controls-container { flex-direction: column; }
            #sr-levels-container { grid-template-columns: 1fr; }
            /* Add other necessary mobile-specific styles here */
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- ... (Existing HTML remains largely the same, but with changes below) ... -->

        <div id="tracker-tab" class="tab-content active">
             <!-- CHART LIBRARY 2 SECTION -->
            <div id="chart-library-2-section" class="collapsible">
                <div class="collapsible-header">
                    <h2>Chart Library 2</h2>
                    <button class="collapsible-toggle">+</button>
                </div>
                <div class="collapsible-content">
                    <!-- Folders or Image Grid will be rendered here by JS -->
                    <div id="chart-library-2-container"></div>
                </div>
            </div>

            <!-- ...other tracker sections below ... -->

        </div>

        <div id="journal-tab" class="tab-content">
            <!-- ...other journal sections here ... -->

            <div id="asset-sentiment-container" class="collapsible">
                <div class="collapsible-header">
                    <h2>Asset Sentiment</h2>
                    <button class="collapsible-toggle">+</button>
                </div>
                <div class="collapsible-content">
                     <!-- Content from asset-sentiment-container -->
                    <h4>Sentiment Log ðŸ‘€</h4>
                    <div class="sentiment-trackers-wrapper">
                        <div class="sentiment-tracker" id="sentiment-tracker-btc">
                            <h4>BTC/USDT</h4>
                            <div class="sentiment-buttons">
                                <button data-asset="BTC/USDT" data-sentiment="long">Long</button>
                                <button data-asset="BTC/USDT" data-sentiment="neutral">Neutral</button>
                                <button data-asset="BTC/USDT" data-sentiment="short">Short</button>
                            </div>
                        </div>
                        <div class="sentiment-tracker" id="sentiment-tracker-eth">
                            <h4>ETH/USDT</h4>
                            <div class="sentiment-buttons">
                                <button data-asset="ETH/USDT" data-sentiment="long">Long</button>
                                <button data-asset="ETH/USDT" data-sentiment="neutral">Neutral</button>
                                <button data-asset="ETH/USDT" data-sentiment="short">Short</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Image Library -->
            <div id="image-library-section" class="collapsible">
                <div class="collapsible-header">
                    <h2>Chart Library</h2>
                    <button class="collapsible-toggle">+</button>
                </div>
                <div class="collapsible-content">
                    <div id="library-upload-section" class="master-only" style="text-align: center; margin-bottom: 20px;">
                        <label for="library-image-upload" class="image-upload-label">Add to Library</label>
                        <input type="file" id="library-image-upload" accept="image/*" multiple>
                        <div id="library-upload-progress" style="margin-top: 10px; font-style: italic; color: var(--link-color);"></div>
                    </div>
                    <div id="image-library-container"></div>
                </div>
            </div>

            <!-- ...rest of the Journal Tab content -->

        </div>

        <!-- ... (Rest of your HTML remains the same) ... -->

    </div>

    <!-- ... (Your JavaScript code remains largely the same, with updates below) ... -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // ... (Your existing JavaScript code) ...

            // --- COLLAPSIBLE SECTION HANDLING ---
            document.querySelectorAll('.collapsible').forEach(item => {
                const header = item.querySelector('.collapsible-header');
                const content = item.querySelector('.collapsible-content');
                const toggle = item.querySelector('.collapsible-toggle');

                header.addEventListener('click', () => {
                    content.classList.toggle('collapsed');
                    toggle.textContent = content.classList.contains('collapsed') ? '+' : '-';
                });
            });


            // ... (Rest of your JavaScript code) ...
        });
    </script>
</body>
</html>
